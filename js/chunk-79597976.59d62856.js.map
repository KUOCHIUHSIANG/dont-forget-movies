{"version":3,"sources":["webpack:///./src/views/Search.vue?d7f6","webpack:///src/views/Search.vue","webpack:///./src/views/Search.vue?9c29","webpack:///./src/views/Search.vue","webpack:///./src/views/Search.vue?15aa"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","keyword","_e","searchResult","length","isLoading","attrs","toWatchMovies","on","afterAddToWatch","afterDeleteToWatch","staticRenderFns","STORAGE_KEY","created","components","ListTemplateVue","LoadingSpinner","data","methods","id","posterPath","title","originalTitle","releaseDate","inToWatch","console","saveStorage","localStorage","movie","toWatchMovie","filterToWatch","filterDeleteToWatch","watch","handler","deep","beforeRouteUpdate","next","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,6BAA6B,CAACF,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACN,EAAIO,GAAG,YAAYP,EAAIQ,GAAGR,EAAIS,SAAS,eAAgBT,EAAa,UAAEI,EAAG,kBAAkBJ,EAAIU,KAAkC,IAA5BV,EAAIW,aAAaC,QAAiBZ,EAAIa,UAAyEb,EAAIa,UAAsNb,EAAIU,KAA/MN,EAAG,kBAAkB,CAACU,MAAM,CAAC,iBAAiBd,EAAIW,aAAa,0BAA0BX,EAAIe,eAAeC,GAAG,CAAC,qBAAqBhB,EAAIiB,gBAAgB,wBAAwBjB,EAAIkB,sBAAlQd,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACN,EAAIO,GAAG,eAAoP,IACpnBY,EAAkB,G,oCCuBtB,MAAMC,EAAc,kBAEL,OACfC,UACA,uCACA,+BACA,4DAEAC,YACAC,uBACAC,uBAEAC,OACA,OACAhB,WACAM,iBACAJ,gBACAE,eAGAa,SACA,qBACA,IACA,eACA,WAAAD,SAAA,oBAAAhB,YAEA,qCACAkB,QACAC,yBACAC,cACAC,+BACAC,2BACAC,gBAEA,wDACA,kBACA,SACA,kBACAC,yBAGAC,cACAC,4DAEAlB,mBACAmB,eACA,SACAT,QACAE,cACAC,8BACAF,wBACAG,0BACAC,uBAGA,2BACA,yDAEAd,sBACAkB,eACA,6CACAC,gBAEA,oEAEAC,iBACA,gBACA,gCACA,4CACA,kCACAF,gBAGA,SAEA,WAIA,UAEAG,yBACA,eACA,SACA,IACA,EACAP,cAGA,GAIA,WAGAQ,OACAzB,eACA0B,mBACA,oBAEAC,UAGAC,yBACA,kBACA,wBACA,oBACAC,MCpIgV,I,wBCQ5UC,EAAY,eACd,EACA9C,EACAoB,GACA,EACA,KACA,WACA,MAIa,aAAA0B,E,kECnBf","file":"js/chunk-79597976.59d62856.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container py-5 movie-list\"},[_c('div',{staticClass:\"movie-list__title\"},[_vm._v(\" 您搜尋的關鍵字 \"+_vm._s(_vm.keyword)+\" ，搜尋結果為： \")]),(_vm.isLoading)?_c('LoadingSpinner'):_vm._e(),(_vm.searchResult.length === 0 && !_vm.isLoading)?_c('div',{staticClass:\"empty-result\"},[_vm._v(\" 搜尋不到電影 \")]):(!_vm.isLoading)?_c('ListTemplateVue',{attrs:{\"initial-movies\":_vm.searchResult,\"initial-to-watch-movies\":_vm.toWatchMovies},on:{\"after-add-to-watch\":_vm.afterAddToWatch,\"after-delete-to-watch\":_vm.afterDeleteToWatch}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"container py-5 movie-list\">\n    <div class=\"movie-list__title\">\n      您搜尋的關鍵字 {{ keyword }} ，搜尋結果為：\n    </div>\n    <LoadingSpinner v-if=\"isLoading\" />\n    <div v-if=\"searchResult.length === 0 && !isLoading\" class=\"empty-result\">\n      搜尋不到電影\n    </div>\n    <ListTemplateVue\n      v-else-if=\"!isLoading\"\n      :initial-movies=\"searchResult\"\n      :initial-to-watch-movies=\"toWatchMovies\"\n      @after-add-to-watch=\"afterAddToWatch\"\n      @after-delete-to-watch=\"afterDeleteToWatch\"\n    />\n  </div>\n</template>\n\n<script>\nimport ListTemplateVue from \"../components/ListTemplate.vue\";\nimport LoadingSpinner from \"../components/LoadingSpinner.vue\";\nimport moviesAPI from \"../apis/movies\";\n\nconst STORAGE_KEY = \"to-watch-movies\";\n\nexport default {\n  created() {\n    this.keyword = this.$route.query.keyword;\n    this.searchMovie(this.keyword);\n    this.toWatchMovies = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];\n  },\n  components: {\n    ListTemplateVue,\n    LoadingSpinner,\n  },\n  data() {\n    return {\n      keyword: \"\",\n      toWatchMovies: [],\n      searchResult: [],\n      isLoading: true,\n    };\n  },\n  methods: {\n    async searchMovie(keyword) {\n      try {\n        this.keyword = keyword;\n        const { data } = await moviesAPI.searchMovie({ keyword });\n\n        this.searchResult = data.results.map((movie) => ({\n          id: movie.id,\n          posterPath: movie.poster_path,\n          title: movie.title,\n          originalTitle: movie.original_title,\n          releaseDate: movie.release_date,\n          inToWatch: false,\n        }));\n        this.searchResult = this.filterToWatch(this.searchResult);\n        this.isLoading = false;\n      } catch (error) {\n        this.isLoading = false;\n        console.log(\"error\", error);\n      }\n    },\n    saveStorage() {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(this.toWatchMovies));\n    },\n    afterAddToWatch(movie) {\n      movie.inToWatch = true;\n      const listMovie = {\n        id: movie.id,\n        title: movie.title,\n        originalTitle: movie.originalTitle,\n        posterPath: movie.posterPath,\n        releaseDate: movie.releaseDate,\n        inToWatch: movie.inToWatch,\n      };\n\n      this.toWatchMovies.push(listMovie);\n      this.searchResult = this.filterToWatch(this.searchResult);\n    },\n    afterDeleteToWatch(movie) {\n      movie.inToWatch = false;\n      this.toWatchMovies = this.toWatchMovies.filter(\n        (toWatchMovie) => toWatchMovie.id !== movie.id\n      );\n      this.searchResult = this.filterDeleteToWatch(movie.id, this.searchResult);\n    },\n    filterToWatch(unfilteredMovies) {\n      let filteredToWatchMovies = unfilteredMovies.map((movie) => {\n        if (this.toWatchMovies.length > 0) {\n          for (let i = 0; i < this.toWatchMovies.length; i++) {\n            if (movie.id === this.toWatchMovies[i].id) {\n              movie.inToWatch = true;\n            }\n          }\n          return movie;\n        } else {\n          return movie;\n        }\n      });\n\n      return filteredToWatchMovies;\n    },\n    filterDeleteToWatch(movieId, unfilteredMovies) {\n      let filteredToWatchMovies = unfilteredMovies.map((unfilteredMovie) => {\n        if (unfilteredMovie.id === movieId) {\n          return {\n            ...unfilteredMovie,\n            inToWatch: false,\n          };\n        } else {\n          return unfilteredMovie;\n        }\n      });\n\n      return filteredToWatchMovies;\n    },\n  },\n  watch: {\n    toWatchMovies: {\n      handler: function () {\n        this.saveStorage();\n      },\n      deep: true,\n    },\n  },\n  beforeRouteUpdate(to, from, next) {\n    this.isLoading = true;\n    const keyword = to.query.keyword;\n    this.searchMovie(keyword);\n    next();\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"../assets/scss/movie-list-shared-style.scss\";\n\n.movie-list {\n  max-width: 1040px;\n  font-size: 0.9rem;\n  .empty-result {\n    font-size: 1rem;\n    text-align: center;\n    padding: 5rem 0;\n    color: #ffffff77;\n  }\n}\n\n/* media query */\n// Small devices , > 576px\n@media screen and (min-width: 576px) {\n  .movie-list {\n    font-size: 0.8rem;\n  }\n}\n\n// Medium devices , > 768px\n@media screen and (min-width: 768px) {\n  .movie-list {\n    font-size: 0.7rem;\n  }\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Search.vue?vue&type=template&id=4a294582&scoped=true&\"\nimport script from \"./Search.vue?vue&type=script&lang=js&\"\nexport * from \"./Search.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Search.vue?vue&type=style&index=0&id=4a294582&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4a294582\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=style&index=0&id=4a294582&lang=scss&scoped=true&\""],"sourceRoot":""}